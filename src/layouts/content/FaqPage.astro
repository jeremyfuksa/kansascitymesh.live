---
/**
 * Campfire Design System - FAQ Page Layout
 * Question/answer format with expandable details elements
 */
import CampfireInnerPage from "./CampfireInnerPage.astro";
import CampfireDiscordCTA from "../../components/campfire/CampfireDiscordCTA.astro";

const { entry } = Astro.props as { entry: any };
const { Content } = await entry.render();
const data = entry.data ?? {};
const {
  title = "",
  description = "",
  pageHeading,
  faqs = [],
  discordInvite,
  breadcrumbs = [],
  tableOfContents = [],
  meta,
} = data as Record<string, any>;
---

<CampfireInnerPage
  title={pageHeading ?? title}
  description={description}
  breadcrumbs={breadcrumbs}
  tableOfContents={tableOfContents}
  meta={meta}
  seoTitle={title}
  seoDescription={description}
>
  {/* Main Content */}
  <article class="content-body prose prose-neutral dark:prose-invert max-w-none">
    <Content />
  </article>

  {/* FAQ Accordion */}
  {faqs.length > 0 && (
    <div class="mt-10 space-y-4">
      {faqs.map((faq: any, index: number) => {
        const paragraphs = String(faq.answer ?? "").split(/\n\s*\n/);
        return (
          <details class="group bg-white dark:bg-neutral-900 border border-neutral-200 dark:border-neutral-800 rounded-[20px] p-6 shadow-[0px_1px_3px_0px_rgba(76,98,125,0.12),0px_1px_2px_0px_rgba(76,98,125,0.08)]" key={`faq-${index}`}>
            <summary class="flex items-center justify-between gap-4 cursor-pointer list-none">
              <span class="text-[18px] font-bold text-neutral-900 dark:text-neutral-50">
                {faq.question}
              </span>
              <span class="w-10 h-10 rounded-[10px] bg-neutral-100 dark:bg-neutral-800 flex items-center justify-center text-neutral-500 group-open:rotate-45 transition-transform shrink-0">
                <i class="fa-solid fa-plus" aria-hidden="true"></i>
              </span>
            </summary>
            <div class="mt-4 text-[15px] lg:text-[16px] text-neutral-600 dark:text-neutral-400 leading-[1.7] space-y-3">
              {paragraphs.map((paragraph, pIndex) => (
                <p key={`faq-${index}-p-${pIndex}`}>
                  {paragraph.trim()}
                </p>
              ))}
            </div>
          </details>
        );
      })}
    </div>
  )}

  {/* Discord CTA */}
  {discordInvite && (
    <div class="mt-8">
      <CampfireDiscordCTA
        title={discordInvite.title}
        description={discordInvite.description}
        link={discordInvite.link}
        linkText={discordInvite.linkText}
      />
    </div>
  )}
</CampfireInnerPage>
