---
import Layout from "../Layout.astro";
import DetailsAccordion from "../../components/DetailsAccordion.astro";
import DiscordInviteCard from "../../components/DiscordInviteCard.astro";

const { entry } = Astro.props as { entry: any };
const { Content } = await entry.render();
const data = entry.data ?? {};
const {
  title = "",
  description = "",
  pageHeading,
  heroVariant,
  faqs = [],
  discordInvite,
} = data as Record<string, any>;
const renderedFaqs = faqs.map((faq: any) => ({
  question: faq.question,
  answer: faq.answer,
}));
---

<Layout
  title={title}
  description={description}
  pageHeading={pageHeading}
  heroVariant={heroVariant}
>
  <article class="prose prose-lg max-w-none">
    <Content />
  </article>

  {renderedFaqs.length > 0 && (
    <div class="space-y-4">
      {renderedFaqs.map((faq, index) => (
        <DetailsAccordion summary={faq.question} key={`faq-${index}`}>
          <p class="whitespace-pre-line text-sm text-gray-700">{faq.answer}</p>
        </DetailsAccordion>
      ))}
    </div>
  )}

  {discordInvite && (
    <DiscordInviteCard
      title={discordInvite.title}
      description={discordInvite.description}
      link={discordInvite.link}
      linkText={discordInvite.linkText}
    />
  )}
</Layout>
