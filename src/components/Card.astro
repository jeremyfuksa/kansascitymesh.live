---
/**
 * Standardized card used across grids, supporting status badges and optional imagery.
 */
interface Props {
  title: string;
  description?: string;
  link?: string;
  linkText?: string;
  status?: "operational" | "gap" | "needed" | "suggested";
  image?: string;
  imageAlt?: string;
}

const { title, description, link, linkText, status, image, imageAlt } = Astro.props;

const statusMap: Record<string, { label: string; variant: string }> = {
  operational: { label: "LIVE", variant: "success" },
  gap: { label: "GAP", variant: "warning" },
  needed: { label: "NEEDED", variant: "secondary" },
  suggested: { label: "SUGGESTED", variant: "info" },
};

const badge = status ? statusMap[status] ?? null : null;
---

<div class="col">
  <div class="card h-100 shadow" style="border: 1px solid rgba(212, 130, 92, 0.15); transition: transform 0.2s ease, box-shadow 0.2s ease;" onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 0.5rem 1rem rgba(0,0,0,0.15)';" onmouseout="this.style.transform=''; this.style.boxShadow=''">
    <div class="card-body d-flex flex-column gap-3">
      {image && (
        <img
          src={image}
          alt={imageAlt ?? ""}
          class="img-fluid rounded mb-2"
          loading="lazy"
          decoding="async"
        />
      )}
      <div class="d-flex justify-content-between align-items-start gap-3">
        <h3 class="h5 fw-semibold mb-0">{title}</h3>
        {badge && (
          <span class={`badge text-bg-${badge.variant}`}>{badge.label}</span>
        )}
      </div>
      {description && <p class="card-text text-body-secondary mb-0">{description}</p>}
      {link && linkText && (
        <div class="mt-auto">
          <a
            href={link}
            class="link-primary fw-semibold"
            target={link.startsWith("/") ? undefined : "_blank"}
            rel={link.startsWith("/") ? undefined : "noopener noreferrer"}
          >
            {linkText}
          </a>
        </div>
      )}
    </div>
  </div>
</div>
